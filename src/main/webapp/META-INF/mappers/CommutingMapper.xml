<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper
  PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
  "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.awoo.dao.CommutingDAO">
	<select id="selectCommuting" resultType="CommutingVO">
		select id, workday, DATE_FORMAT(start_time, '%H:%i') as start_time, DATE_FORMAT(end_time, '%H:%i') as end_time, work_time, over_time, empno
		from commuting order by id desc;
	</select>
	<insert id="insertEnter" keyProperty="id">
		INSERT INTO commuting(start_time, empno) 
		VALUES (#{startTime}, #{empno});
	</insert>
	<update id="insertLeave">
		update commuting
			set end_time = #{endTime},
				work_time = #{workTime},
				over_time = #{overTime}
			WHERE empno=#{empno} AND DATE_FORMAT(workday, '%Y-%m-%d') = #{workday};
	</update>
	<select id="getStartTime" resultType="String">
<!-- 		select DATE_FORMAT(start_time, '%H:%i:%s %p') -->

<!-- 		select DATE_FORMAT(start_time, '%Y-%m-%d %H:%i:%s') -->
		select DATE_FORMAT(start_time, '%H:%i')
		from commuting WHERE DATE_FORMAT(workday, '%Y-%m-%d') = #{workday} AND empno=#{empno};
	</select>
		<select id="getEndTime" resultType="String">
<!-- 		select DATE_FORMAT(start_time, '%H:%i:%s %p') -->
<!-- 		select DATE_FORMAT(end_time, '%Y-%m-%d %H:%i:%s') -->
		select DATE_FORMAT(end_time, '%H:%i')
		from commuting WHERE DATE_FORMAT(workday, '%Y-%m-%d') = #{workday} AND empno=#{empno};
	</select>
	<select id="getDistinctYear" resultType="String">
		select distinct(DATE_FORMAT(workday, '%Y')) from commuting order by (DATE_FORMAT(workday, '%Y')) desc
	</select>
	<select id="getDistinctMonth" resultType="String">
		select distinct(DATE_FORMAT(workday, '%m')) from commuting order by (DATE_FORMAT(workday, '%m')) desc;
	</select>
</mapper>